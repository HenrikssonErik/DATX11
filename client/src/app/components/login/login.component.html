<app-spinner></app-spinner>
<div class="d-flex justify-content-center">
  <div class="flip-card">
    <div class="flip-card-inner" id="flip-card-inner">
      <div class="flip-card-front card p-4">
        <div class="container">
          <form (ngSubmit)="onSubmitSignUp()" [formGroup]="signUpForm">
            <h3 class="text-center text-muted mb-4" translate>
              Hydrant_Sign_Up
            </h3>
            <div class="form-group mb-3">
              <label for="cid" class="text-muted">Chalmers ID (CID)</label>
              <input
                [ngClass]="{
                  success: signUpForm.get('cid')?.valid,
                  error:
                    signUpForm.get('cid')?.invalid &&
                    (signUpForm.get('cid')?.dirty ||
                      signUpForm.get('cid')?.touched)
                }"
                type="text"
                [(ngModel)]="cid"
                formControlName="cid"
                class="form-control focus-border"
                id="cid"
                placeholder="{{ 'Enter_Cid' | translate }}"
                (focus)="onInputFocus('cid', signUpForm)"
                required
              />
              <!--  <div class="error-message" *ngIf="signUpForm.get('cid')?.invalid && (signUpForm.get('cid')?.dirty || signUpForm.get('cid')?.touched)">
                Please enter a CID
              </div> -->
            </div>
            <div class="form-group mb-3">
              <label for="signUpEmail" class="text-muted" translate
                >Email_address<span
                  ><i
                    class="fa-regular fa-circle-question"
                    data-bs-toggle="tooltip"
                    data-bs-placement="top"
                    data-bs-title="
                      Only Chalmers email is allowed"
                  ></i></span
              ></label>
              <div class="input-group">
                <input
                  type="email"
                  formControlName="signUpEmail"
                  class="form-control text-muted"
                  onfocus="this.blur()"
                  placeholder="{{ 'same_as_cid' | translate }}"
                  id="signUpEmail"
                  [value]="cid"
                  readonly
                />
                <span class="input-group-text" id="emailending"
                  >@chalmers.se</span
                >
              </div>
              <!--  <div class="error-message" *ngIf="signUpForm.get('signUpEmail')?.invalid && (signUpForm.get('signUpEmail')?.dirty || signUpForm.get('signUpEmail')?.touched)">
                Please enter a valid email address.
              </div> -->
            </div>
            <div class="form-group mb-1">
              <label for="signUpPassword" class="text-muted" translate
                >Password</label
              >
              <div class="input-group passwordInput">
                <input
                  [ngClass]="{
                    success: signUpForm.get('signUpPassword')?.valid,
                    error:
                      signUpForm.get('signUpPassword')?.invalid &&
                      (signUpForm.get('signUpPassword')?.dirty ||
                        signUpForm.get('signUpPassword')?.touched)
                  }"
                  type="password"
                  maxlength="33"
                  formControlName="signUpPassword"
                  class="form-control focus-border"
                  id="signUpPassword"
                  placeholder="{{ 'Password' | translate }}"
                  (focus)="onInputFocus('signUpPassword', signUpForm)"
                  required
                />
                <button type="button">
                  <i
                    class="fa-regular fa"
                    [ngClass]="{
                      'fa-eye': !passwordVisible,
                      'fa-eye-slash': passwordVisible
                    }"
                    (click)="showPassword('signUpPassword')"
                  ></i>
                </button>
              </div>
              <!--  <div class="error-message" *ngIf="signUpForm.get('password')?.invalid && (signUpForm.get('password')?.dirty || signUpForm.get('password')?.touched)">
                Please enter a password.
              </div> -->
            </div>
            <div class="form-group form-check mt-3">
              <input
                type="checkbox"
                formControlName="termsAndCon"
                class="form-check-input"
                id="termsAndCon"
              />
              <label
                class="form-check-label text-muted"
                for="termsAndCon"
                translate
                >I_agree_to_the
                <a
                  href="https://www.youtube.com/watch?v=dQw4w9WgXcQ&ab_channel=RickAstley"
                  style="color: inherit"
                  target="_blank"
                  translate
                  >Terms_and_Conditions</a
                ></label
              >
            </div>
            <button
              type="submit"
              class="btn btn-primary btn-block mt-3 w-100"
              [disabled]="signUpForm.invalid"
              translate
            >
              Sign_Up_btn
            </button>
            <div class="text-center">
              <p class="mt-3 text-muted mb-0" translate>
                Already_have_an_account
                <a
                  [routerLink]=""
                  (click)="flipTo('login')"
                  style="color: inherit"
                  class="signUp-link"
                  href="/signup"
                  translate
                  >Login</a
                >
              </p>
              <p class="mt-2 text-muted mb-0" translate>
                Verify_text
                <a
                  [routerLink]=""
                  href="#"
                  class="verification-link"
                  (click)="openVerificationModal()"
                  data-bs-toggle="modal"
                  data-bs-target="#exampleModal"
                  role="button"
                  translate
                >
                  Click_here_verification
                </a>
              </p>
            </div>
          </form>
        </div>
      </div>

      <div class="flip-card-back card p-4">
        <div class="container">
          <form (ngSubmit)="onSubmitLogin()" [formGroup]="loginForm">
            <h3 class="text-center text-muted mb-4" translate>HYDRANT_LOGIN</h3>
            <div class="form-group mb-3">
              <label for="email" class="text-muted" translate
                >Email_address</label
              >
              <input
                [ngClass]="{
                  success: loginForm.get('email')?.valid,
                  error:
                    loginForm.get('email')?.invalid &&
                    (loginForm.get('email')?.dirty ||
                      loginForm.get('email')?.touched)
                }"
                type="email"
                formControlName="email"
                class="form-control focus-border"
                id="email"
                placeholder="{{ 'Enter_email' | translate }}"
                (focus)="onInputFocus('email', loginForm)"
                required
              />
              <!--  <div class="error-message" *ngIf="loginForm.get('email')?.invalid && (loginForm.get('email')?.dirty || loginForm.get('email')?.touched)">
                Please enter a valid email address.
              </div> -->
            </div>
            <div class="form-group mb-2">
              <label for="password" class="text-muted" translate
                >Password</label
              >
              <div class="input-group passwordInput">
                <input
                  [ngClass]="{
                    success: loginForm.get('password')?.valid,
                    error:
                      loginForm.get('password')?.invalid &&
                      (loginForm.get('password')?.dirty ||
                        loginForm.get('password')?.touched)
                  }"
                  type="password"
                  maxlength="33"
                  formControlName="password"
                  class="form-control focus-border"
                  id="password"
                  placeholder="{{ 'Password' | translate }}"
                  (focus)="onInputFocus('password', loginForm)"
                  required
                />
                <button type="button">
                  <i
                    class="fa-regular fa"
                    [ngClass]="{
                      'fa-eye': !passwordVisible,
                      'fa-eye-slash': passwordVisible
                    }"
                    (click)="showPassword('password')"
                  ></i>
                </button>
              </div>
              <!--  <div class="error-message" *ngIf="loginForm.get('password')?.invalid && (loginForm.get('password')?.dirty || loginForm.get('password')?.touched)">
                Please enter a password.
              </div> -->
            </div>
            <div class="form-group form-check">
              <input
                type="checkbox"
                formControlName="rememberMe"
                class="form-check-input"
                id="rememberMe"
              />
              <label
                class="form-check-label text-muted"
                for="rememberMe"
                translate
                >Remember_me</label
              >
            </div>
            <button
              type="submit"
              class="btn btn-primary btn-block mt-4 w-100"
              [disabled]="loginForm.invalid"
              translate
            >
              Login
            </button>
            <p style="float: right" class="mt-2 mb-0 text-muted ml-auto">
              <a
                style="color: inherit"
                href="#"
                (click)="openPwdModal()"
                data-bs-toggle="modal"
                data-bs-target="#pwdModal"
                translate
                >Forgot_Password?</a
              >
            </p>
            <div style="clear: both"></div>
            <!--  <div class="error-message text-center mt-4" *ngIf="submitFailed">
              Please enter valid email and password.
            </div> -->
            <h2><span translate>Or</span></h2>
            <button
              type="button"
              class="btn btn-secondary btn-block mt-3 w-100"
              translate
            >
              Login_with_Chalmers-SSO
            </button>

            <div class="text-center">
              <p class="mt-3 text-muted mb-0" translate>
                Need_an_account
                <a
                  [routerLink]=""
                  (click)="flipTo('signUp')"
                  class="signUp-link"
                  href="/signup"
                  translate
                  >Sign_Up</a
                >
              </p>
              <p class="mt-2 text-muted mb-0" translate>
                Verify_text
                <a
                  [routerLink]=""
                  href="#"
                  class="verification-link"
                  (click)="openVerificationModal()"
                  data-bs-toggle="modal"
                  data-bs-target="#exampleModal"
                  role="button"
                  translate
                >
                  Click_here_verification
                </a>
              </p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="pwdModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog verificationModal">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" translate>
          Forgot_pwd_title
        </h5>
        <button
          type="button"
          id="closePwdModal"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <form (ngSubmit)="onSubmitForgotPwd()" [formGroup]="forgotPwdForm">
        <div class="modal-body">
          <label for="pwd" class="text-muted" translate
            >Chalmers ID (CID)</label
          >
          <input
            [ngClass]="{
              success: forgotPwdForm.get('cid')?.valid,
              error:
                forgotPwdForm.get('cid')?.invalid &&
                (forgotPwdForm.get('cid')?.dirty ||
                  forgotPwdForm.get('cid')?.touched)
            }"
            type="text"
            formControlName="cid"
            class="form-control focus-border"
            id="verCid"
            placeholder="{{ 'Enter_Cid' | translate }}"
            (focus)="onInputFocus('cid', forgotPwdForm)"
            required
          />
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
            translate
          >
            Close
          </button>
          <button
            type="submit"
            [disabled]="forgotPwdForm.invalid"
            class="btn btn-primary btn-success-bg"
            translate
          >
            Forgot_pwd_btn
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog verificationModal">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" translate>
          Send_verification_link_title
        </h5>
        <button
          type="button"
          id="closeVerModal"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <form
        (ngSubmit)="onResendVerification()"
        [formGroup]="verificationCidForm"
      >
        <div class="modal-body">
          <label for="verCid" class="text-muted" translate
            >Chalmers ID (CID)</label
          >
          <input
            [ngClass]="{
              success: verificationCidForm.get('cid')?.valid,
              error:
                verificationCidForm.get('cid')?.invalid &&
                (verificationCidForm.get('cid')?.dirty ||
                  verificationCidForm.get('cid')?.touched)
            }"
            type="text"
            formControlName="cid"
            class="form-control focus-border"
            id="verCid"
            placeholder="{{ 'Enter_Cid' | translate }}"
            (focus)="onInputFocus('cid', verificationCidForm)"
            required
          />
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
            translate
          >
            Close
          </button>
          <button
            type="submit"
            [disabled]="verificationCidForm.invalid"
            class="btn btn-primary btn-success-bg"
            translate
          >
            Send_verification_link_btn
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
