<div class="row mt-3 d-flex flex-row flex-wrap nowrap">
  <div class="dropdown">
    <button
      class="hydrantDropdown text-muted"
      type="button"
      hydrantDropdown
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Assignment <i class="fa-solid fa-chalkboard-user"></i>
    </button>
    <ul class="dropdown-menu">
      <li *ngFor="let assignment of assignmentNumbers">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            value="assignment"
            id="{{ 'assignmentCheckbox-' + assignment }}"
            (click)="filterAssignments(assignment)"
            [checked]="selectedAssignment === assignment"
          />
          <label
            (click)="filterAssignments(assignment); $event.stopPropagation()"
            class="form-check-label text-muted"
            for="assignmentCheckbox"
          >
            Assignment {{ assignment }}
          </label>
        </div>
      </li>
    </ul>
    <button
      class="hydrantDropdown text-muted"
      type="button"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Graded <i class="fa-solid fa-graduation-cap"></i>
    </button>
    <ul class="dropdown-menu">
      <li>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            value=""
            id="checkbox1"
          />
          <label class="form-check-label" for="checkbox1"> No </label>
        </div>
      </li>
      <li>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            value=""
            id="checkbox2"
          />
          <label class="form-check-label" for="checkbox2"> Yes </label>
        </div>
      </li>
    </ul>
    <button
      class="hydrantDropdown text-muted"
      type="button"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Date <i class="fa-solid fa-clock"></i>
    </button>
    <ul class="dropdown-menu">
      <li><a class="dropdown-item" href="#">Action</a></li>
      <li><a class="dropdown-item" href="#">Another action</a></li>
      <li><a class="dropdown-item" href="#">Something else here</a></li>
    </ul>
  </div>
  <div class="dropdown"></div>
</div>
<div class="row">
  <div class="form-outline mt-2">
    <input
      type="search"
      id="form1"
      class="form-control"
      placeholder="Search..."
      aria-label="Search"
      [(ngModel)]="searchText"
      (input)="onSearchTextChanged()"
    />
  </div>
</div>
<div class="row mt-3">
  <div class="col-12 text-muted">
    <div *ngIf="gradeingSubmission">
      <ng-container
        *ngIf="gradeingSubmission.Submissions.length > 0; else noSubmissions"
      >
        <ngb-accordion #submissionAccordion="ngbAccordion">
          <ngb-panel *ngFor="let submission of gradeingSubmission.Submissions">
            <ng-template ngbPanelTitle>
              <div class="titleAccordion">
                <span
                  >Assignment {{ gradeingSubmission.Assignment }} - Group
                  {{ submission.groupid }}</span
                >
                <span class="statusText" *ngIf="submission.grade">Graded</span>
                <span class="statusText" *ngIf="!submission.grade"
                  >Not Graded</span
                >
              </div>
            </ng-template>
            <ng-template ngbPanelContent>
              <div class="row" *ngIf="submission.grade">
                <div
                  class="col-12 d-flex justify-content-end"
                  [formGroup]="form"
                >
                  <div class="form-group form-check">
                    <input
                      type="checkbox"
                      class="form-check-input"
                      formControlName="gradeAgain"
                      id="gradeAgain"
                      (click)="testMethod(submission.grade)"
                    />
                    <label
                      class="form-check-label text-muted"
                      for="gradeAgain"
                      translate
                    >
                      Grade_Again
                    </label>
                  </div>
                </div>
              </div>
              <div class="row text-muted" *ngIf="submission.grade">
                <div class="col-md-3">
                  <p>Graded by</p>
                  <p>Malte</p>
                </div>
                <div class="col-md-3">
                  <p>Date Graded</p>
                  <p>2020-12-13</p>
                </div>
                <div class="col-md-3">
                  <p>Score</p>
                  <p>12/20</p>
                </div>
                <div class="col-md-3">
                  <p>Passed</p>
                  <p>True</p>
                </div>
              </div>

              <div class="row text-muted">
                <div class="col-md-2">
                  <p class="header">Test Result</p>

                  <p
                    (click)="
                      openFeedBackModal(
                        submission.groupid,
                        gradeingSubmission.Assignment
                      )
                    "
                    class="testResult"
                    [ngStyle]="{
                      color: submission.testpass ? '#006c5c' : '#8b0000'
                    }"
                  >
                    <ng-container *ngIf="submission.testpass; else failed">
                      Passed
                    </ng-container>
                    <ng-template #failed> Failed </ng-template>
                    <span
                      ><i class="fa-solid fa-up-right-from-square"></i
                    ></span>
                  </p>
                </div>
                <div class="col-md-2">
                  <p class="header">Time Submitted</p>
                  <p>2023-04-01 at 23:49</p>
                </div>
                <div *ngIf="fileNames" class="col-md-3">
                  <p class="header">Files submitted</p>
                  <p
                    *ngFor="let file of fileNames"
                    class="submissionFiles"
                    (click)="
                      downloadSubmissionFile(
                        submission.groupid,
                        gradeingSubmission.Assignment,
                        submission.Submission,
                        file
                      )
                    "
                  >
                    {{ file }}
                  </p>
                </div>

                <div class="col-md-5">
                  <p class="header">Leave a comment</p>
                  <fieldset
                    [disabled]="
                      !form.get('gradeAgain')?.value ||
                      submission.grade !== null
                    "
                  >
                    <textarea
                      class="form-control"
                      placeholder="Leave a comment here"
                      id="comments"
                      style="height: 175px"
                      [value]="submission.Feedback"
                    ></textarea>
                  </fieldset>
                </div>
              </div>
              <div class="row mt-2 justify-content-end">
                <div class="col-md-3">
                  <button
                    [disabled]="!form.get('gradeAgain')?.value"
                    style="float: right"
                    class="btn btn-primary"
                    (click)="
                      setSubmissionGrade(
                        submission,
                        gradeingSubmission.Assignment,
                        true
                      )
                    "
                  >
                    Pass
                  </button>
                  <button
                    [disabled]="!form.get('gradeAgain')?.value"
                    style="float: right; margin-right: 5px"
                    class="btn btn-danger"
                    (click)="
                      setSubmissionGrade(
                        submission,
                        gradeingSubmission.Assignment,
                        false
                      )
                    "
                  >
                    Fail
                  </button>
                </div>
              </div>
            </ng-template>
          </ngb-panel>
        </ngb-accordion>
      </ng-container>
    </div>
  </div>
</div>
<ng-template #noSubmissions>
  <p>No assignments found.</p>
</ng-template>
